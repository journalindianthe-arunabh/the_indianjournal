<h2>Upload News</h2>
<form id="newsForm">
  <input type="text" id="title" placeholder="Heading" required><br><br>
  <textarea id="content" placeholder="Content" required></textarea><br><br>
  <input type="file" id="image"><br><br>
  <input type="text" id="video" placeholder="Video URL (optional)"><br><br>
  <button type="submit">Upload</button>
</form>

<script type="module">
  import { db, storage } from "./firebase-init.js"; // (or same script in index.html)
  import { collection, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";
  import { ref, uploadBytes, getDownloadURL } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-storage.js";

  const form = document.getElementById("newsForm");

  form.addEventListener("submit", async (e) => {
    e.preventDefault();

    const title = document.getElementById("title").value;
    const content = document.getElementById("content").value;
    const video = document.getElementById("video").value;
    const imageFile = document.getElementById("image").files[0];

    let imageUrl = "";
    if (imageFile) {
      const storageRef = ref(storage, "images/" + imageFile.name);
      await uploadBytes(storageRef, imageFile);
      imageUrl = await getDownloadURL(storageRef);
    }

    await addDoc(collection(db, "articles"), {
      title,
      content,
      videoUrl: video,
      imageUrl,
      createdAt: serverTimestamp()
    });

    alert("News uploaded!");
    form.reset();
  });
</script>
